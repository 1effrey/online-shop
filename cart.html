<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>femmes.fb | Your Cart</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: Arial, sans-serif; 
      background: #ffd8e4;
      margin: 0; padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #e91e63;
    }
    .cart-list {
      max-width: 600px;
      margin: 0 auto 30px;
      padding: 10px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .cart-item {
      display: grid;
      grid-template-columns: 1fr 120px 80px;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid #eee;
    }
    .cart-item:last-child {
      border-bottom: none;
    }
    .qty-controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      justify-content: center;
    }
    .qty-number {
      font-weight: bold;
      font-size: 1.3em;
      text-align: center;
    }
   .qty-buttons-row {
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    button.qty-btn {
      background: #e91e63;
      border: none;
      color: white;
      padding: 5px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1.3em;
      user-select: none;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    button.qty-btn:disabled {
      background: #f8bbd0;
      cursor: not-allowed;
    }
    #clear-cart-btn {
      background: #c2185b;
      color: #fff;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin-bottom: 15px;
      display: block;
      max-width: 150px;
    }
    #clear-cart-btn:hover {
      background: #a31549;
    }
    form {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: bold;
    }
    input[type="text"], input[type="email"], textarea {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 1em;
    }
    .total {
      text-align: right;
      font-size: 1.2em;
      margin-top: 15px;
      font-weight: bold;
    }
    button.submit-btn {
      display: block;
      width: 100%;
      background: #e91e63;
      border: none;
      color: white;
      font-size: 1.2em;
      padding: 12px;
      margin-top: 20px;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Your Cart - femmes.fb</h1>

  <section class="cart-list" id="cart-list">
    <h2>Cart Items</h2>
    <button id="clear-cart-btn">Clear Cart</button>
    <div id="cart-items">
      <p>Your cart is empty.</p>
    </div>
    <div class="total" id="total-price">Total: $0</div>
  </section>

  <form id="order-form">
    <h2>Customer Info</h2>
    <label for="email">Email:</label>
    <input type="email" id="email" placeholder="your.email@example.com" required />

    <label for="phone">Phone Number:</label>
    <input type="text" id="phone" placeholder="+9617xxxxxxx" required />

    <label for="location">Location / Address:</label>
    <textarea id="location" placeholder="Your address here" rows="3" required></textarea>

    <button type="submit" class="submit-btn">Submit Order via WhatsApp</button>
  </form>

  <script>
    const cartItemsEl = document.getElementById('cart-items');
    const totalPriceEl = document.getElementById('total-price');
    const orderForm = document.getElementById('order-form');
    const clearCartBtn = document.getElementById('clear-cart-btn');

    // Load cart from localStorage
    let cart = JSON.parse(localStorage.getItem('femmesCart')) || {};

    // Format price
    function formatPrice(num) {
      return '$' + num.toFixed(2);
    }

    // Render cart items with detached +/- buttons centered below quantity
    function renderCart() {
      const items = Object.entries(cart);
      if (items.length === 0) {
        cartItemsEl.innerHTML = '<p>Your cart is empty.</p>';
        totalPriceEl.textContent = 'Total: $0';
        return;
      }
      let html = '';
      let total = 0;
      for (const [name, item] of items) {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        html += `
          <div class="cart-item" data-name="${name}">
            <span>${name} - ${formatPrice(item.price)}</span>
            <div class="qty-controls">
              <span class="qty-number">${item.quantity}</span>
              <div class="qty-buttons-row">
                <button class="qty-btn" data-name="${name}" data-action="decrease">âˆ’</button>
                <button class="qty-btn" data-name="${name}" data-action="increase">+</button>
              </div>
            </div>
            <span>${formatPrice(itemTotal)}</span>
          </div>
        `;
      }
      cartItemsEl.innerHTML = html;
      totalPriceEl.textContent = 'Total: ' + formatPrice(total);
    }

    // Update quantity
    function updateQuantity(name, action) {
      if (!cart[name]) return;
      if (action === 'increase') {
        cart[name].quantity += 1;
      } else if (action === 'decrease') {
        cart[name].quantity -= 1;
        if (cart[name].quantity <= 0) {
          delete cart[name];
        }
      }
      localStorage.setItem('femmesCart', JSON.stringify(cart));
      renderCart();
    }

    // Event delegation for qty buttons
    cartItemsEl.addEventListener('click', e => {
      if (e.target.classList.contains('qty-btn')) {
        const name = e.target.getAttribute('data-name');
        const action = e.target.getAttribute('data-action');
        updateQuantity(name, action);
      }
    });

    // Clear cart button handler
    clearCartBtn.addEventListener('click', () => {
      if (confirm('Are you sure you want to clear your cart?')) {
        cart = {};
        localStorage.removeItem('femmesCart');
        renderCart();
      }
    });

    // Handle form submit
    orderForm.addEventListener('submit', e => {
      e.preventDefault();

      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const location = document.getElementById('location').value.trim();

      if (Object.keys(cart).length === 0) {
        alert('Your cart is empty. Please add some products first.');
        return;
      }
      if (!email || !phone || !location) {
        alert('Please fill all the customer info fields.');
        return;
      }

      const date = new Date().toLocaleDateString();

      let message = `Order from femmes.fb:%0ADate: ${date}%0AItems:%0A`;
      let total = 0;
      for (const [name, item] of Object.entries(cart)) {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        message += `- ${name} x${item.quantity}: $${itemTotal.toFixed(2)}%0A`;
      }
      message += `%0ATotal: $${total.toFixed(2)}%0A%0ACustomer info:%0A`;
      message += `Email: ${encodeURIComponent(email)}%0A`;
      message += `Phone: ${encodeURIComponent(phone)}%0A`;
      message += `Location: ${encodeURIComponent(location)}`;

      // WhatsApp number (Lebanon)
      const whatsappNumber = '96176608282';
      const whatsappURL = `https://wa.me/${whatsappNumber}?text=${message}`;

      // Open WhatsApp chat
      window.open(whatsappURL, '_blank');

      // Clear cart and form after order
      localStorage.removeItem('femmesCart');
      cart = {};
      renderCart();
      orderForm.reset();
    });

    // Initial render
    renderCart();
  </script>
</body>
</html>
